
<canvas id="life" width="700" height="700"></canvas>
<script>
    
    m=document.getElementById("life").getContext('2d')
    mheight = document.getElementById("life").width
    console.log(mheight)
    draw=(x,y,c,s)=>{
        m.fillStyle=c
        m.fillRect(x,y,s,s)
    }
    particles=[]
    particle=(x,y,c)=>{
        return{"x":x,"y":y,"vx":0,"vy":0,"color":c}
    }

    random=()=>{
        return Math.random()*(mheight-100)+50
    }
    create=(number,color)=>{
        group=[]
        for(let i= 0; i<number;i++){
            group.push(particle(random(),random(),color))
            particles.push(group[i])
        }
        return group
    }
    rule = (particles1,particles2,g)=>{
        let vel_multi = 0.5
        for(let i = 0; i<particles1.length;i++){

        
            fx = 0
            fy = 0
            for(let j = 0;j<particles2.length;j++){
                a = particles1[i]
                b = particles2[j]
                dx = a.x-b.x
                dy = a.y-b.y
                d=Math.sqrt(dx*dx+dy*dy)
                if(d > 0 && d < 80){
                    F = g * 1/d
                    fx += (F * dx)
                    fy += (F * dy)
                }
                
            }
            a.vx = (a.vx + fx)*vel_multi
            a.vy = (a.vy + fy)*vel_multi
            a.x += a.vx
            a.y += a.vy
            if(a.x<=0 || a.x >= mheight){a.vx*=-1}
            if(a.y<=0 || a.y >= mheight){a.vy*=-1}
        }
    }
    y = create(200,"yellow")
    r = create(100, "red")
    g = create(200,"green")
    //w = create(400,"white")
    //p = create(5,"purple")
    update=()=>{
        rule(r,g,-0.5) // r -> g at 0.32
        
        rule(g,r,0.1)
        rule(y,g,-0.32)
        


        //Fast moving bodies
        /*
        rule(g,g,-0.32)
        rule(g,r,-0.17)
        rule(g,y,0.34)
        rule(r,r,-0.10)
        rule(r,g,-0.14)
        rule(y,y,0.15)
        rule(y,g,-0.20)

        /*rule(g,w,-0.1)
        rule(w,g,0.2)
        rule(w,r,-0.1)
        rule(g,p,-2)
        rule(p,p,0.5)
        rule(w,p,0.1)
        rule(p,y,0.1)
        rule(w,w,0.1)
        rule(p,w,-0.4)*/
        m.clearRect(0,0,mheight,mheight)
        draw(0,0,"black",mheight)
        for(let i=0; i<particles.length;i++){
            draw(particles[i].x,particles[i].y,particles[i].color,5)

        }
        requestAnimationFrame(update)
    }
    update();
</script>
